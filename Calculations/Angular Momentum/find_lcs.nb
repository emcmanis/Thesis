(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     66777,       1802]
NotebookOptionsPosition[     61000,       1625]
NotebookOutlinePosition[     61390,       1642]
CellTagsIndexPosition[     61347,       1639]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Notebook for Finding Critical Values of \[Lambda]"
}], "Title",
 CellChangeTimes->{{3.540306636902382*^9, 3.540306665812695*^9}}],

Cell["\<\
Here is my actual code that I actually ran to get my thesis data. For easier \
data collection, this was run as a loop once all the bugs were worked out. I \
present here the expanded version, which can be compressed and looped if \
desired.\
\>", "Text",
 CellChangeTimes->{{3.540306669044539*^9, 3.540306712917094*^9}, {
  3.540306746328044*^9, 3.5403067514460077`*^9}}],

Cell[CellGroupData[{

Cell["Finding candidate ranges", "Section",
 CellChangeTimes->{{3.539016437663969*^9, 3.5390164403089323`*^9}}],

Cell[CellGroupData[{

Cell["Setup", "Subsection",
 CellChangeTimes->{{3.5390164053571978`*^9, 3.539016409700904*^9}, {
  3.540217620221322*^9, 3.5402176227169867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"l", "=", "2"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"Angular", " ", "momentum", " ", "quantum", " ", "number"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5402162274182777`*^9, 3.540216234312664*^9}, {
  3.543114873257472*^9, 3.5431148734261837`*^9}, {3.543115495083787*^9, 
  3.543115495389675*^9}, {3.543510917659074*^9, 3.543510917806768*^9}, {
  3.543511147672492*^9, 3.5435111483638763`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RoughCritical", "[", "\[Lambda]_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"H", ",", "res", ",", "d\[Rho]", ",", "\[Rho]inf", ",", "nn"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d\[Rho]", "=", "0.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]inf", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"20", "*", "\[Lambda]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"nn", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"\[Rho]inf", "/", "d\[Rho]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n_", ",", "n_"}], "}"}], "\[Rule]", 
           RowBox[{
            FractionBox["2.", 
             SuperscriptBox["d\[Rho]", "2"]], "-", 
            RowBox[{
             FractionBox["2.", 
              RowBox[{"n", "*", "d\[Rho]"}]], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "n"}], "*", 
               RowBox[{"d\[Rho]", "/", "\[Lambda]"}]}]]}], "+", 
            FractionBox[
             RowBox[{"l", "*", 
              RowBox[{"(", 
               RowBox[{"l", "+", "1"}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "*", "d\[Rho]"}], ")"}], "^", "2"}]]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n_", ",", " ", "m_"}], "}"}], "/;", " ", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"n", "-", "m"}], "]"}], " ", "\[Equal]", " ", "1"}]}], 
           " ", "\[Rule]", " ", 
           FractionBox[
            RowBox[{"-", "1."}], 
            SuperscriptBox["d\[Rho]", "2"]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nn", ",", "nn"}], "}"}], ",", " ", "0."}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"H", ",", 
         RowBox[{"-", "100"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5390158685780363`*^9, 3.539015871101367*^9}, {
   3.53901591943513*^9, 3.539015935217182*^9}, {3.53901600476367*^9, 
   3.539016008427278*^9}, {3.539016127747554*^9, 3.5390161280126057`*^9}, 
   3.5390163894865522`*^9, {3.539016462324894*^9, 3.539016486399221*^9}, {
   3.539016548826387*^9, 3.539016552986286*^9}, {3.539099086158347*^9, 
   3.5390990862780037`*^9}, {3.5391390039796953`*^9, 
   3.5391390042126093`*^9}, {3.54021624714962*^9, 3.54021625194832*^9}}],

Cell[TextData[{
 "This function takes a value of lambda and returns the 100 eigenvalues of \
the hamiltonian which have the lowest absolute value. nn is the matrix size, \
d\[Rho] is the step size, and \[Rho]inf is numerical infinity for the \
problem.\n\nThe results of this calculation are extremely sensitive to \
\[Rho]inf, and a larger \[Rho]inf makes for less error. However, for larger \
values of \[Rho]inf, more ",
 StyleBox["positive",
  FontSlant->"Italic"],
 " eigenvalues are found near 0, because the positive eigenvalues are in a \
continuous spectrum. As the grid becomes a better approximation of reality, \
more of these are picked up. This squeezes the negative eigenvalues (whose \
spectrum starts near -1) out, especially at higher values of \[Lambda]. In \
order to ensure that there are *some* negative eigenvalues, we therefore pin \
\[Rho]inf to some constant factor times \[Lambda]. "
}], "Text",
 CellChangeTimes->{
  3.540216239728427*^9, {3.5402162718311357`*^9, 3.540216333941002*^9}, {
   3.540216977073237*^9, 3.540217062577939*^9}, {3.5402172545224648`*^9, 
   3.5402172810522747`*^9}, {3.5402174004666967`*^9, 3.540217472535021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountNegs", "[", "list_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"neg", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"neg", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{
        RowBox[{"list", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"neg", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "neg", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{3.5390163894870167`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindLs", "[", 
   RowBox[{"l0_", ",", "lf_", ",", "val_", ",", "vaf_", ",", "range_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mid", ",", "vam", ",", "lnegs", ",", "mnegs", ",", "hnegs", ",", 
      "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mid", "=", 
      RowBox[{"l0", "+", 
       FractionBox[
        RowBox[{"lf", "-", "l0"}], "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lnegs", "=", 
      RowBox[{"CountNegs", "[", "val", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vam", "=", 
      RowBox[{"RoughCritical", "[", "mid", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mnegs", "=", 
      RowBox[{"CountNegs", "[", "vam", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hnegs", "=", 
      RowBox[{"CountNegs", "[", "vaf", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lf", "-", "l0"}], ">", "range"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lnegs", "<", "mnegs"}], " ", "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lnegs", "\[Equal]", "mnegs"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"val", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
              RowBox[{"vam", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&&", " ", 
             RowBox[{"mnegs", ">", "0"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"res", ",", 
              RowBox[{"FindLs", "[", 
               RowBox[{
               "l0", ",", "mid", ",", "val", ",", "vam", ",", "range"}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mnegs", "<", "hnegs"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"hnegs", "\[Equal]", "mnegs"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"vam", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
              RowBox[{"vaf", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
             RowBox[{"hnegs", ">", "0"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"res", ",", 
              RowBox[{"FindLs", "[", 
               RowBox[{
               "mid", ",", "lf", ",", "vam", ",", "vaf", ",", "range"}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Found one!\>\"", "]"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"this", " ", "lets", " ", "you", " ", "know", " ", 
          RowBox[{"it", "'"}], "s", " ", "working"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"l0", ",", "lf"}], "}"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5390160212254333`*^9, 3.539016022503304*^9}, {
   3.539016061561664*^9, 3.539016107531227*^9}, {3.5390161435373096`*^9, 
   3.539016157009387*^9}, {3.5390161921374207`*^9, 3.539016257482386*^9}, 
   3.539016389488509*^9, {3.5390164910828753`*^9, 3.5390164914821863`*^9}, {
   3.5390983802099953`*^9, 3.539098460137817*^9}, {3.539098564016499*^9, 
   3.539098577680982*^9}, 3.539098797081745*^9, {3.5390994221204767`*^9, 
   3.539099479099491*^9}, 3.539099942789166*^9, {3.539099984412463*^9, 
   3.539100022754026*^9}, {3.539100110892888*^9, 3.539100115457612*^9}, {
   3.539100488105488*^9, 3.539100495413364*^9}, {3.539100570058125*^9, 
   3.5391005786774063`*^9}, {3.54021977060246*^9, 3.54021977644217*^9}}],

Cell["\<\
This is my multiple rootfinder, to find ranges where a zero occurs. Again, \
when we bisect, we are looking at the number of negative eigenvalues as a \
function of lambda. In this routine, we assume multiple zeroes, and keep \
bisecting any range with a zero in it.

The complicated conditional for bisection is meant to deal with the problem \
of negative eigenvalues getting squeezed out by positive ones. Given a half \
of the input range, it bisects that half if either the number of negative \
eigenvalues increases (a regular zero), or the number of negative eigenvalues \
stays constant, but the value of the first negative eigenvalue jumps. This \
indicates that one negative eigenvalue was squeezed out, but another was \
added. In general, as \[Lambda] increases, the negative eigenvalues should \
decrease in value (coming closer and closer to the Coulomb energies). \
\>", "Text",
 CellChangeTimes->{{3.5402174972704782`*^9, 3.5402175315094757`*^9}, {
  3.5402176765147657`*^9, 3.5402177302649508`*^9}, {3.540217764136372*^9, 
  3.540217838973731*^9}, {3.5402180614351273`*^9, 3.540218070079752*^9}, {
  3.54021814905459*^9, 3.540218192348908*^9}, {3.540218316698448*^9, 
  3.540218395423558*^9}, {3.540218962266849*^9, 3.540219017471558*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RangeChunk", "[", 
   RowBox[{"low_", ",", "high_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "val", ",", "vaf", ",", "lnegs", ",", "hnegs"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"val", "=", 
      RowBox[{"RoughCritical", "[", "low", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lnegs", "=", 
      RowBox[{"CountNegs", "[", "val", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vaf", "=", 
      RowBox[{"RoughCritical", "[", "high", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hnegs", "=", 
      RowBox[{"CountNegs", "[", "vaf", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lnegs", "<", "hnegs"}], " ", "||", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lnegs", "\[Equal]", "hnegs"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"val", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
           RowBox[{"vaf", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", " ", 
          RowBox[{"hnegs", ">", "0"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"res", "=", 
         RowBox[{"FindLs", "[", 
          RowBox[{"low", ",", "high", ",", "val", ",", "vaf", ",", "1"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5390243657998734`*^9, 3.539024373684915*^9}, {
  3.539024407285041*^9, 3.539024457783689*^9}, {3.539098517566963*^9, 
  3.539098529232304*^9}, {3.5390987897650747`*^9, 3.539098841837298*^9}, {
  3.5390988815787888`*^9, 3.539098898330863*^9}, {3.539099166256822*^9, 
  3.539099250792904*^9}, {3.539100448033113*^9, 3.5391004556193132`*^9}, {
  3.5391004987660837`*^9, 3.539100499132864*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculation", "Subsection",
 CellChangeTimes->{{3.540217628492135*^9, 3.5402176299070873`*^9}}],

Cell["\<\
Here the parallelization starts. All of those calls to Eigenvalues aren\
\[CloseCurlyQuote]t cheap, and the range-finding can be paralellized as well \
as the actual bisection calculation. RangeChunk, above, is just a wrapper for \
the function that finds ranges. It does the initial calculation and makes \
sure there\[CloseCurlyQuote]s a zero inside the the range before sending it \
off to be bisected.\
\>", "Text",
 CellChangeTimes->{{3.540219076910409*^9, 3.540219086709485*^9}, {
  3.540219117397542*^9, 3.540219136236134*^9}, {3.5402191692842703`*^9, 
  3.5402192423614073`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NoKernels", "=", "21"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "kernels", " ", "in", " ", "the", " ", 
    "Lightweight", " ", "Grid"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.5402192446503057`*^9, 3.540219258666006*^9}}],

Cell[BoxData[
 RowBox[{"int", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"5.", "*", 
      RowBox[{"10", "^", "5"}]}], "-", 
     RowBox[{"0.25", "/", "2"}]}], ")"}], "/", "NoKernels"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{"chunks", "=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"2", "*", "int"}], "+", "0.25"}], "]"}]}], "}"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", "NoKernels"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"chunks", "=", 
    RowBox[{"Append", "[", 
     RowBox[{"chunks", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"chunks", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"chunks", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
          RowBox[{"2", "*", "int"}]}], "]"}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.5390986635471983`*^9, 3.539098748837775*^9}, {
   3.539098925530178*^9, 3.539098929808119*^9}, {3.539099006678644*^9, 
   3.5390990240911694`*^9}, {3.539100742624858*^9, 3.539100745695463*^9}, 
   3.5402175872324057`*^9}],

Cell["\<\
The range -- \[Lambda] = 0.5 to 1000 -- gets divided up based on the length \
of time it takes to run Eigenvalues there. The timing of Eigenvalues is \
roughly linear with \[Rho]inf. The amount of time it takes to find a range \
will therefore be approximately the integral of this line over the range.\
\>", "Text",
 CellChangeTimes->{{3.5402192655049677`*^9, 3.5402195386418867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributeDefinitions", "[", 
   RowBox[{
   "RangeChunk", ",", "CountNegs", ",", "chunks", ",", "FindLs", ",", 
    "RoughCritical", ",", "l"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Every", " ", "kernel", " ", "needs", " ", "all", " ", "of", " ", "the", 
    " ", "functions", " ", "and", " ", "lists", " ", "being", " ", "used"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.539100763378221*^9, 3.5391007928896313`*^9}, {
  3.5402195442671423`*^9, 3.5402195547064457`*^9}, {3.540221092112488*^9, 
  3.540221092393257*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rangesrough", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"RangeChunk", "[", 
      RowBox[{
       RowBox[{"chunks", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"chunks", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "chunks", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.539100438729433*^9, 3.53910048160891*^9}, {
  3.539100636208405*^9, 3.539100649514001*^9}, {3.539100758924336*^9, 
  3.539100760152831*^9}, {3.539100798250482*^9, 3.539100825053975*^9}}],

Cell["\<\
This comes out as a list of lists of pairs, and we just want a list of pairs. \
So we massage it a little.\
\>", "Text",
 CellChangeTimes->{{3.540219575121484*^9, 3.540219602968129*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ranges", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.53910061229661*^9, 3.539100622015382*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{"Length", "[", "rangesrough", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ranges", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"ranges", ",", 
       RowBox[{"rangesrough", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.539100623030294*^9, 3.539100629465806*^9}, {
  3.539100673965157*^9, 3.539100701585557*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rootfinding for Lcs", "Section",
 CellChangeTimes->{{3.539034157448365*^9, 3.539034166830002*^9}}],

Cell[CellGroupData[{

Cell["Setup", "Subsection",
 CellChangeTimes->{{3.539034168251726*^9, 3.5390341720778913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Critical", "[", 
   RowBox[{"\[Lambda]_", ",", "consts_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"H", ",", "res", ",", "d\[Rho]", ",", "\[Rho]inf", ",", "nn"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d\[Rho]", "=", 
      RowBox[{"consts", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]inf", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"consts", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nn", "=", 
      RowBox[{"Round", "[", 
       RowBox[{"\[Rho]inf", "/", "d\[Rho]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"H", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n_", ",", "n_"}], "}"}], "\[Rule]", 
           RowBox[{
            FractionBox["2.", 
             SuperscriptBox["d\[Rho]", "2"]], "-", 
            RowBox[{
             FractionBox["2.", 
              RowBox[{"n", "*", "d\[Rho]"}]], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "n"}], "*", 
               RowBox[{"d\[Rho]", "/", "\[Lambda]"}]}]]}], "+", 
            FractionBox[
             RowBox[{"l", 
              RowBox[{"(", 
               RowBox[{"l", "+", "1"}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "*", "d\[Rho]"}], ")"}], "^", "2"}]]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n_", ",", " ", "m_"}], "}"}], "/;", " ", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"n", "-", "m"}], "]"}], " ", "\[Equal]", " ", "1"}]}], 
           " ", "\[Rule]", " ", 
           FractionBox[
            RowBox[{"-", "1."}], 
            SuperscriptBox["d\[Rho]", "2"]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nn", ",", "nn"}], "}"}], ",", " ", "0."}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"H", ",", 
         RowBox[{"-", "100"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Went", " ", "from", " ", "100", " ", "down", " ", "to", " ", "25", 
        " ", "eigenvalues"}], ",", " ", 
       RowBox[{
       "which", " ", "sped", " ", "this", " ", "calculation", " ", "up", " ", 
        "immensely", " ", "with", " ", "no", " ", "apparent", " ", "loss", 
        " ", "of", " ", "information"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5301162397411633`*^9, 3.530116240591889*^9}, {
   3.53011661218509*^9, 3.5301166269157248`*^9}, {3.530116667619584*^9, 
   3.530116669041018*^9}, 3.5301185498979273`*^9, {3.538802615478559*^9, 
   3.538802668671652*^9}, {3.538802759989481*^9, 3.538802770368887*^9}, {
   3.5388030998035307`*^9, 3.538803136122018*^9}, {3.538803212356885*^9, 
   3.538803217218152*^9}, {3.53886796172024*^9, 3.5388679641360273`*^9}, {
   3.538868121269012*^9, 3.538868186450102*^9}, {3.5388682242298727`*^9, 
   3.5388682534489403`*^9}, {3.540219618941237*^9, 3.540219624820806*^9}, {
   3.543115326136155*^9, 3.5431153262962217`*^9}, {3.543115362716007*^9, 
   3.543115362946002*^9}, {3.543115552401806*^9, 3.543115552691822*^9}, {
   3.5431156503201017`*^9, 3.54311569567661*^9}, {3.543115765479313*^9, 
   3.543115765612007*^9}, {3.5431158792199907`*^9, 3.543115879372548*^9}}],

Cell["\<\
This is another version of the RoughCritical function above that only takes \
the 25 eigenvalues closest to 0. It also allows d\[Rho] and \[Rho]inf to be \
varied. Decreasing the number of eigenvalues taken sped up the calculation a \
lot, and if on every range we have 0 eigenvalues at the lower end and 1 on \
the upper end, that\[CloseCurlyQuote]s no big deal -- that\[CloseCurlyQuote]s \
a zero.\
\>", "Text",
 CellChangeTimes->{{3.540219632519911*^9, 3.54021973266916*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bisect", "[", 
   RowBox[{"F_", ",", "consts_", ",", "x0_", ",", "xf_", ",", "\[Epsilon]_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mid", ",", "val", ",", "lnegs", ",", "vam", ",", "mnegs", ",", "vah"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mid", "=", 
      RowBox[{"x0", "+", 
       FractionBox[
        RowBox[{"Abs", "[", 
         RowBox[{"x0", "-", "xf"}], "]"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Bisecting. Midpoint is \>\"", "<>", 
       RowBox[{"ToString", "[", "mid", "]"}]}], "]"}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Again", ",", " ", 
       RowBox[{"lets", " ", "you", " ", "know", " ", 
        RowBox[{"it", "'"}], "s", " ", 
        RowBox[{"working", "/", "progress"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"val", "=", 
      RowBox[{"F", "[", 
       RowBox[{"x0", ",", "consts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lnegs", "=", 
      RowBox[{"CountNegs", "[", "val", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vam", "=", 
      RowBox[{"F", "[", 
       RowBox[{"mid", ",", "consts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mnegs", "=", 
      RowBox[{"CountNegs", "[", "vam", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xf", "-", "x0"}], ">", "\[Epsilon]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lnegs", "<", "mnegs"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lnegs", "\[Equal]", "mnegs"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"val", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
              RowBox[{"vam", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], ",", " ", 
          RowBox[{"(*", 
           RowBox[{
           "if", " ", "there", " ", "is", " ", "a", " ", "zero", " ", "on", 
            " ", "the", " ", "lower", " ", "half"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"Bisect", "[", 
             RowBox[{
             "F", ",", "consts", ",", "x0", ",", "mid", ",", "\[Epsilon]"}], 
             "]"}], "]"}], ";"}], ",", " ", 
          RowBox[{"(*", 
           RowBox[{"bisect", " ", "it"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"Bisect", "[", 
             RowBox[{
             "F", ",", "consts", ",", "mid", ",", "xf", ",", "\[Epsilon]"}], 
             "]"}], "]"}], ";"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
          "otherwise", " ", "try", " ", "the", " ", "upper", " ", "half"}], 
          "*)"}], "\[IndentingNewLine]", "]"}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vah", " ", "=", " ", 
         RowBox[{"F", "[", 
          RowBox[{"xf", ",", "consts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"mid", ",", "lnegs", ",", 
           RowBox[{"CountNegs", "[", "vah", "]"}]}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.530115616834133*^9, 3.5301156252633038`*^9}, {
   3.530115745223833*^9, 3.5301158155111523`*^9}, {3.5301158490391483`*^9, 
   3.530115880391429*^9}, {3.530116076471526*^9, 3.5301161089602213`*^9}, {
   3.530116641202567*^9, 3.5301166784474077`*^9}, 3.530118498281904*^9, 
   3.5301185415946493`*^9, {3.530118807986784*^9, 3.530118837216745*^9}, {
   3.530118892162161*^9, 3.530118995156069*^9}, {3.530119137781747*^9, 
   3.530119171339416*^9}, {3.530119327245511*^9, 3.53011932792365*^9}, {
   3.530119591119488*^9, 3.530119595819223*^9}, 3.530288556842297*^9, {
   3.537039529702327*^9, 3.537039548599237*^9}, {3.5370397042292957`*^9, 
   3.5370397049180307`*^9}, {3.537047864940765*^9, 3.537047886492227*^9}, {
   3.537657033571357*^9, 3.537657041500163*^9}, {3.540219750643631*^9, 
   3.5402197509916153`*^9}, {3.540219782242721*^9, 3.540219797249703*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Bisect", "[", 
  RowBox[{"Critical", ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "1600."}], "}"}], ",", "0.8", ",", "0.9", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "6"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5431148865141077`*^9, 3.543114926560566*^9}, {
  3.543115264424176*^9, 3.543115295475959*^9}, {3.5431154632590647`*^9, 
  3.543115464347324*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Bisecting. Midpoint is 0.85\"\>"], "Print",
 CellChangeTimes->{
  3.543114927096753*^9, 3.543115296162415*^9, 3.5431153348609047`*^9, 
   3.543115366034952*^9, {3.543115531093877*^9, 3.543115557913816*^9}}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.825\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.5431155611712418`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.8375\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.54311556441608*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.84375\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.5431155676519136`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840625\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.543115570922524*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.842188\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.543115574160993*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.842969\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.543115577374887*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843359\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.5431155806655283`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843164\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.543115583946396*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843262\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.54311558717439*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843311\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.543115590413783*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843286\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.543115593663454*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843274\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.543115596955674*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843268\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.54311560020774*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843271\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.5431156034587708`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843272\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.5431156067080584`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843273\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.54311560996283*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.843273\"\>"], "Print",
 CellChangeTimes->{3.543114927096753*^9, 3.543115296162415*^9, 
  3.5431153348609047`*^9, 3.543115366034952*^9, 3.543115531093877*^9, 
  3.5431156143135757`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8432727813720704`", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.543114937792027*^9, 3.5431153184661627`*^9, 
  3.543115354622321*^9, 3.543115448381338*^9, 3.543115548344781*^9, 
  3.5431156180945263`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Bisect", "[", 
  RowBox[{"Critical", ",", 
   RowBox[{"{", 
    RowBox[{"0.05", ",", "3200."}], "}"}], ",", "0.80", ",", "0.9", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "6"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.543115628123569*^9, 3.543115632752392*^9}, {
  3.5431157340010633`*^9, 3.543115734207241*^9}, {3.5431158230871067`*^9, 
  3.5431158318472633`*^9}, {3.543115862582819*^9, 3.54311589471419*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Bisecting. Midpoint is 0.85\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115900385207*^9}}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.825\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543115939685231*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.8375\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543115978939706*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.84375\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543116017710338*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840625\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543116056202009*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.842188\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543116094452201*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.841406\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.5431161339065332`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.841016\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.5431161735484257`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.84082\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.5431162122779007`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840918\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543116251548321*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840869\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.5431162903565483`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840894\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543116329375305*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840906\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543116369276072*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.8409\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.54311640873847*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840897\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543116447768792*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840898\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543116486449535*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840897\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.5431165251956253`*^9}],

Cell[BoxData["\<\"Bisecting. Midpoint is 0.840898\"\>"], "Print",
 CellChangeTimes->{{3.54311563321327*^9, 3.543115699497303*^9}, 
   3.543115734706764*^9, 3.543115772175909*^9, {3.5431158338718977`*^9, 
   3.543115888279544*^9}, 3.543116563163548*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8408977508544924`", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.543115644320005*^9, 3.543115685519177*^9}, {
   3.543115729819387*^9, 3.54311575052142*^9}, 3.5431158058226624`*^9, {
   3.543115847869529*^9, 3.5431158982123823`*^9}, 3.543116620657938*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%57", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"%41", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "-", 
    RowBox[{"%57", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.543116660820407*^9, 3.54311671206532*^9}, {
  3.543116768663445*^9, 3.5431167725682592`*^9}}],

Cell[BoxData["0.8385227203369143`"], "Output",
 CellChangeTimes->{{3.5431166818102818`*^9, 3.543116712509334*^9}, {
  3.543116774338776*^9, 3.54311677689493*^9}}]
}, Open  ]],

Cell["\<\
Bisection rootfinder, finding where a new negative eigenvalue appears. It \
returns not only the midpoint, but the number of negative eigenvalues at the \
low and high ends of the final range. This allows for a quick eyeball check \
if necessary to verify that there is in fact a zero where the function says \
there is.\
\>", "Text",
 CellChangeTimes->{{3.540219845962758*^9, 3.54021985533813*^9}, {
  3.5402199018081284`*^9, 3.540219940615498*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Findlc", "[", 
   RowBox[{"input_", ",", "i_", ",", "eps_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "vah", ",", "lnegs", ",", "hnegs", ",", "res"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<***Beginning to calculate the \>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<th lambda, part \>\"", 
       "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"input", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"val", "=", 
      RowBox[{"Critical", "[", 
       RowBox[{
        RowBox[{"input", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", 
          RowBox[{"input", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"input", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "0.1"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"vah", "=", 
      RowBox[{"Critical", "[", 
       RowBox[{
        RowBox[{"input", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", 
          RowBox[{"input", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"input", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "0.1"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"lnegs", "=", 
      RowBox[{"CountNegs", "[", "val", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hnegs", "=", 
      RowBox[{"CountNegs", "[", "vah", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lnegs", "<", "hnegs"}], " ", "||", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lnegs", "\[Equal]", "hnegs"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"val", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", 
           RowBox[{"vah", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{"doublechecks", " ", "for", " ", "zero"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Pass!\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"input", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"Bisect", "[", 
            RowBox[{"Critical", ",", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", 
               RowBox[{"input", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"input", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "/", "0.1"}]}], "}"}], ",", 
             RowBox[{"input", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"input", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", "eps"}], "]"}]}], "}"}]}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Fail!\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"input", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "Null"}], "}"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.530226314420801*^9, 3.530226465246111*^9}, {
   3.530226713391532*^9, 3.530226958728467*^9}, {3.530227112561317*^9, 
   3.530227160441638*^9}, {3.530227422105815*^9, 3.530227429608878*^9}, {
   3.530227877019434*^9, 3.5302279383927937`*^9}, {3.530227984419868*^9, 
   3.5302281036811867`*^9}, {3.530228138701189*^9, 3.530228148099204*^9}, {
   3.5302284611650667`*^9, 3.530228481009631*^9}, {3.530228542690007*^9, 
   3.5302287330634823`*^9}, {3.530229585649015*^9, 3.5302296435849953`*^9}, 
   3.5302885568617163`*^9, {3.537039060483687*^9, 3.537039061771584*^9}, {
   3.537048208288788*^9, 3.5370482139178867`*^9}, {3.539018361056962*^9, 
   3.5390183752022257`*^9}}],

Cell["\<\
This is the wrapper for parallel bisection. It makes sure that there is in \
fact a zero in the range, because the \[Rho]inf dependence means that \
sometimes the critical \[Lambda] drifts out of the range. Any bisections done \
where there is no zero in the range would return the upper endpoint and be \
useless.\
\>", "Text",
 CellChangeTimes->{{3.5402199489032297`*^9, 3.540220060188739*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListRandomize", "[", "list_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"order", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"order", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], ",", "i"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"order", " ", "=", " ", 
      RowBox[{"Sort", "[", "order", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"list", "[", 
         RowBox[{"[", 
          RowBox[{"order", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell["\<\
This is a quick-and-dirty optimization for the parallel rootfinding. All it \
does is mix up the inputs so a kernel is less likely to get two long or two \
short calculations.\
\>", "Text",
 CellChangeTimes->{{3.5402200699560738`*^9, 3.540220078116111*^9}, {
  3.5402209318978977`*^9, 3.540221015761108*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rhoinfs", "=", 
    RowBox[{"{", 
     RowBox[{"40", ",", "80"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Scaling", " ", "factors", " ", "for", " ", "\[Lambda]"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.540221023987705*^9, 3.540221031746752*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ranges", "=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"467.4739234841014`", ",", "467.4739234841014`"}], "}"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.543510946848523*^9, 3.54351094737004*^9}, {
  3.543511125210454*^9, 3.543511126069241*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"467.4739234841014`", ",", "467.4739234841014`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.543511127671389*^9, 3.543511173139258*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["First calculations: refinement", "Subsection",
 CellChangeTimes->{{3.539034354720571*^9, 3.5390343599819736`*^9}}],

Cell["\<\
To reduce the number of failed rootfinding attempts, we refined the rough \
ranges above a bit more at different values of \[Rho]inf. The first gets down \
to a range of width 1/4, the second, a range of width 1/32. \
\>", "Text",
 CellChangeTimes->{{3.540221046447463*^9, 3.54022114361089*^9}, {
  3.540221440332905*^9, 3.540221440660904*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"inputslow", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"rhoinfs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"ranges", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"ranges", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "2"}], ",", 
       RowBox[{
        RowBox[{"ranges", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ranges", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5390342127731943`*^9, 3.539034300802642*^9}, 
   3.5390343704264917`*^9}],

Cell["\<\
In order to deal with randomization later, the inputs are tagged with a \
number so they can be sorted again. This number is retained by Findlc.\
\>", "Text",
 CellChangeTimes->{{3.540221202916459*^9, 3.5402212129461193`*^9}, {
  3.5402212480814743`*^9, 3.540221276465622*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"inputslow", "=", 
   RowBox[{"ListRandomize", "[", "inputslow", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.539034597326088*^9, 3.539034604096105*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DistributeDefinitions", "[", 
  RowBox[{
  "Critical", ",", "Bisect", ",", "CountNegs", ",", "Findlc", ",", 
   "inputslow", ",", "l"}], "]"}]], "Input",
 CellChangeTimes->{{3.539034727802565*^9, 3.5390347512079372`*^9}, {
  3.539293778365081*^9, 3.539293778853266*^9}, {3.543511179515678*^9, 
  3.543511179720008*^9}, {3.543511379223864*^9, 3.5435113805034103`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  TagBox["inputslow",
   HoldForm], "}"}]], "Output",
 CellChangeTimes->{3.5435110881413593`*^9, 3.543511180652452*^9, 
  3.543511380895484*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"refinement", "=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Findlc", "[", 
     RowBox[{
      RowBox[{"inputslow", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "i", ",", "0.25"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "inputslow", "]"}]}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.539034585811781*^9, 3.5390345928314123`*^9}, {
  3.5390346277132263`*^9, 3.539034627904958*^9}, {3.539034783769182*^9, 
  3.539034786913083*^9}}],

Cell[BoxData["\<\"***Beginning to calculate the 1th lambda, part 1\"\>"], \
"Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5435113834391613`*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.543511466805068*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"refinement", "=", 
   RowBox[{"Sort", "[", "refinement", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.539034639951797*^9, 3.5390346439113417`*^9}, {
  3.539034708705573*^9, 3.539034710711499*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"refinement", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ranges", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "2"}], "}"}]}], "}"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.543510988467944*^9, 3.543511010052403*^9}, {
  3.5435110633244467`*^9, 3.5435110696174603`*^9}, {3.543511247851294*^9, 
  3.543511247999502*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"inputshigh", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"rhoinfs", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"refinement", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"refinement", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "-", "0.75"}], ",", 
       RowBox[{
        RowBox[{"refinement", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "+", "0.75"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "refinement", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.539034372998849*^9, 3.53903438613024*^9}, {
  3.539034649978346*^9, 3.539034693426428*^9}, {3.5402213147323523`*^9, 
  3.540221314860115*^9}}],

Cell[BoxData[
 RowBox[{"inputshigh", "=", 
  RowBox[{"ListRandomize", "[", "inputshigh", "]"}]}]], "Input",
 CellChangeTimes->{{3.5390347134052687`*^9, 3.5390347193435287`*^9}}],

Cell[BoxData[
 RowBox[{"DistributeDefinitions", "[", "inputshigh", "]"}]], "Input",
 CellChangeTimes->{{3.539034757714672*^9, 3.539034765277754*^9}}],

Cell[BoxData[
 RowBox[{"refinement2", "=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Findlc", "[", 
     RowBox[{
      RowBox[{"inputshigh", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "i", ",", 
      RowBox[{"1", "/", "32."}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "inputshigh", "]"}]}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.539034768661909*^9, 3.539034781365921*^9}, {
  3.539034820034943*^9, 3.5390348297372828`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"refinement2", "=", 
   RowBox[{"Sort", "[", "refinement2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5390348542971897`*^9, 3.539034869023994*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"refinement2", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ranges", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "2"}], "}"}]}], "}"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.543511014711835*^9, 3.543511026251068*^9}, {
  3.543511072661241*^9, 3.543511074419426*^9}, {3.543511244625299*^9, 
  3.543511244883891*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Second calculation: lcs for real", "Subsection",
 CellChangeTimes->{{3.539034835902487*^9, 3.5390348423182583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ref1ins", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"rhoinfs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"refinement", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"refinement", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "-", "1."}], ",", 
       RowBox[{
        RowBox[{"refinement", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "+", "1."}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "refinement", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.543511032591733*^9, 3.5435110358593807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ref2ins", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i", "+", 
        RowBox[{"Length", "[", "ref1ins", "]"}]}], ",", 
       RowBox[{
        RowBox[{"rhoinfs", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"refinement2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"refinement2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "-", "1."}], ",", 
       RowBox[{
        RowBox[{"refinement2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "+", "1."}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "refinement2", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.543511039752536*^9, 3.543511043900885*^9}}],

Cell[TextData[{
 "And now we combine the refined ranges, make input lists out of them, and \
find the values of the \[Lambda]cs to within ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]], "."}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.5402217706174*^9, 3.540221803149364*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"newins", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Sort", "[", "ref1ins", "]"}], ",", 
     RowBox[{"Sort", "[", "ref2ins", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.5390348808629303`*^9, {3.539034960298325*^9, 3.53903496896832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"newins", "=", 
   RowBox[{"ListRandomize", "[", "newins", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5390349624457417`*^9, 3.539034972191924*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DistributeDefinitions", "[", "newins", "]"}]], "Input",
 CellChangeTimes->{{3.53903497874205*^9, 3.539034983647563*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  TagBox["newins",
   HoldForm], "}"}]], "Output",
 CellChangeTimes->{3.543511082683058*^9, 3.543511264028837*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lcs", "=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Findlc", "[", 
     RowBox[{
      RowBox[{"newins", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "i", ",", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "newins", "]"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["\<\"***Beginning to calculate the 1th lambda, part 1\"\>"], \
"Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.543511265062619*^9}],

Cell[BoxData["\<\"***Beginning to calculate the 2th lambda, part 2\"\>"], \
"Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.5435112650766287`*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.543511096357978*^9, 3.543511361568035*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"lcs", "=", 
  RowBox[{"Sort", "[", "lcs", "]"}]}]], "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fitting and Data Analysis", "Section",
 CellChangeTimes->{{3.539035002112176*^9, 3.5390350082223997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lcs", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"lcs", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], "-", 
        RowBox[{"lcs", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "+", 
            RowBox[{
             RowBox[{"Length", "[", "lcs", "]"}], "/", "2"}]}], ",", "2", ",",
            "1"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "lcs", "]"}], "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.539035022474353*^9, 3.5390350287947483`*^9}, {
  3.539035071566321*^9, 3.539035080195834*^9}}],

Cell["\<\
This bit exports the data to a file for further analysis. The directory \
should be set to wherever this notebook is running.\
\>", "Text",
 CellChangeTimes->{{3.540221982468917*^9, 3.540222008171452*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<~/Desktop/Ellen/Thesis/Calculations/Angular Momentum/\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.539220601479047*^9, 3.539220621134047*^9}}],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<l\>\"", "<>", 
    RowBox[{"ToString", "[", "l", "]"}], "<>", "\"\<.csv\>\""}], ",", 
   "data"}], "]"}]], "Input",
 CellChangeTimes->{{3.5392205145615253`*^9, 3.539220561895562*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"dataplot", " ", "=", " ", 
  RowBox[{"ErrorBarPlots`ErrorListPlot", "[", "data", "]"}]}]], "Input",
 CellChangeTimes->{{3.539035096424265*^9, 3.539035096816082*^9}}],

Cell["Quadratic fit", "Text",
 CellChangeTimes->{{3.540222019434523*^9, 3.54022202140971*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fit", "=", 
  RowBox[{"FindFit", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"a", " ", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{"b", " ", "x"}], "+", "c"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.53922042649611*^9, 3.539220431415443*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", "\[Rule]", 
    RowBox[{"-", "0.02204434003481057`"}]}], ",", 
   RowBox[{"b", "\[Rule]", "48.26706804893477`"}], ",", 
   RowBox[{"c", "\[Rule]", 
    RowBox[{"-", "36.58998989696374`"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.539220439952455*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"a", " ", 
    RowBox[{"x", "^", "2"}]}], "+", 
   RowBox[{"b", " ", "x"}], "+", "c"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"fitplot", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "x", "]"}], "/.", "fit"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "35"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"dataplot", ",", "fitplot"}], "]"}]], "Input"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 686},
WindowMargins->{{58, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (October 10, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 197, 5, 88, "Title"],
Cell[767, 29, 382, 7, 49, "Text"],
Cell[CellGroupData[{
Cell[1174, 40, 111, 1, 74, "Section"],
Cell[CellGroupData[{
Cell[1310, 45, 146, 2, 39, "Subsection"],
Cell[1459, 49, 439, 9, 30, "Input"],
Cell[1901, 60, 2803, 70, 202, "Input"],
Cell[4707, 132, 1167, 19, 126, "Text"],
Cell[5877, 153, 770, 21, 145, "Input"],
Cell[6650, 176, 4394, 101, 445, "Input"],
Cell[11047, 279, 1266, 19, 125, "Text"],
Cell[12316, 300, 2067, 49, 221, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14420, 354, 101, 1, 39, "Subsection"],
Cell[14524, 357, 597, 10, 49, "Text"],
Cell[15124, 369, 290, 7, 30, "Input"],
Cell[15417, 378, 215, 7, 30, "Input"],
Cell[15635, 387, 1187, 33, 88, "Input"],
Cell[16825, 422, 396, 6, 49, "Text"],
Cell[17224, 430, 570, 13, 50, "Input"],
Cell[17797, 445, 722, 19, 30, "Input"],
Cell[18522, 466, 196, 4, 30, "Text"],
Cell[18721, 472, 156, 4, 30, "Input"],
Cell[18880, 478, 563, 15, 69, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19492, 499, 104, 1, 74, "Section"],
Cell[CellGroupData[{
Cell[19621, 504, 95, 1, 39, "Subsection"],
Cell[19719, 507, 3698, 87, 221, "Input"],
Cell[23420, 596, 488, 8, 49, "Text"],
Cell[23911, 606, 4335, 101, 349, "Input"],
Cell[CellGroupData[{
Cell[28271, 711, 417, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[28713, 725, 224, 3, 23, "Print"],
Cell[28940, 730, 224, 3, 23, "Print"],
Cell[29167, 735, 222, 3, 23, "Print"],
Cell[29392, 740, 226, 3, 23, "Print"],
Cell[29621, 745, 225, 3, 23, "Print"],
Cell[29849, 750, 225, 3, 23, "Print"],
Cell[30077, 755, 225, 3, 23, "Print"],
Cell[30305, 760, 227, 3, 23, "Print"],
Cell[30535, 765, 225, 3, 23, "Print"],
Cell[30763, 770, 224, 3, 23, "Print"],
Cell[30990, 775, 225, 3, 23, "Print"],
Cell[31218, 780, 225, 3, 23, "Print"],
Cell[31446, 785, 225, 3, 23, "Print"],
Cell[31674, 790, 224, 3, 23, "Print"],
Cell[31901, 795, 227, 3, 23, "Print"],
Cell[32131, 800, 227, 3, 23, "Print"],
Cell[32361, 805, 224, 3, 23, "Print"],
Cell[32588, 810, 227, 3, 23, "Print"]
}, Open  ]],
Cell[32830, 816, 263, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33130, 826, 466, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[33621, 840, 226, 3, 23, "Print"],
Cell[33850, 845, 249, 3, 23, "Print"],
Cell[34102, 850, 250, 3, 23, "Print"],
Cell[34355, 855, 251, 3, 23, "Print"],
Cell[34609, 860, 252, 3, 23, "Print"],
Cell[34864, 865, 252, 3, 23, "Print"],
Cell[35119, 870, 254, 3, 23, "Print"],
Cell[35376, 875, 254, 3, 23, "Print"],
Cell[35633, 880, 253, 3, 23, "Print"],
Cell[35889, 885, 252, 3, 23, "Print"],
Cell[36144, 890, 254, 3, 23, "Print"],
Cell[36401, 895, 252, 3, 23, "Print"],
Cell[36656, 900, 252, 3, 23, "Print"],
Cell[36911, 905, 249, 3, 23, "Print"],
Cell[37163, 910, 252, 3, 23, "Print"],
Cell[37418, 915, 252, 3, 23, "Print"],
Cell[37673, 920, 254, 3, 23, "Print"],
Cell[37930, 925, 252, 3, 23, "Print"]
}, Open  ]],
Cell[38197, 931, 314, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38548, 941, 382, 11, 30, "Input"],
Cell[38933, 954, 162, 2, 30, "Output"]
}, Open  ]],
Cell[39110, 959, 460, 8, 49, "Text"],
Cell[39573, 969, 4366, 106, 297, "Input"],
Cell[43942, 1077, 406, 7, 49, "Text"],
Cell[44351, 1086, 1184, 33, 126, "Input"],
Cell[45538, 1121, 318, 6, 30, "Text"],
Cell[45859, 1129, 311, 9, 30, "Input"],
Cell[CellGroupData[{
Cell[46195, 1142, 278, 7, 30, "Input"],
Cell[46476, 1151, 198, 5, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46723, 1162, 120, 1, 39, "Subsection"],
Cell[46846, 1165, 354, 6, 30, "Text"],
Cell[47203, 1173, 865, 26, 30, "Input"],
Cell[48071, 1201, 287, 5, 30, "Text"],
Cell[48361, 1208, 190, 4, 30, "Input"],
Cell[CellGroupData[{
Cell[48576, 1216, 391, 7, 30, "Input"],
Cell[48970, 1225, 173, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49180, 1235, 540, 14, 30, "Input"],
Cell[49723, 1251, 150, 3, 23, "Print"],
Cell[49876, 1256, 77, 1, 30, "Output"]
}, Open  ]],
Cell[49968, 1260, 234, 5, 30, "Input"],
Cell[50205, 1267, 479, 14, 30, "Input"],
Cell[50687, 1283, 994, 28, 50, "Input"],
Cell[51684, 1313, 177, 3, 30, "Input"],
Cell[51864, 1318, 149, 2, 30, "Input"],
Cell[52016, 1322, 518, 14, 30, "Input"],
Cell[52537, 1338, 187, 4, 30, "Input"],
Cell[52727, 1344, 476, 14, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53240, 1363, 122, 1, 39, "Subsection"],
Cell[53365, 1366, 895, 26, 30, "Input"],
Cell[54263, 1394, 965, 28, 50, "Input"],
Cell[55231, 1424, 332, 9, 30, "Text"],
Cell[55566, 1435, 301, 8, 30, "Input"],
Cell[55870, 1445, 186, 4, 30, "Input"],
Cell[CellGroupData[{
Cell[56081, 1453, 144, 2, 30, "Input"],
Cell[56228, 1457, 143, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56408, 1466, 405, 12, 30, "Input"],
Cell[CellGroupData[{
Cell[56838, 1482, 148, 3, 23, "Print"],
Cell[56989, 1487, 150, 3, 23, "Print"]
}, Open  ]],
Cell[57154, 1493, 99, 1, 30, "Output"]
}, Open  ]],
Cell[57268, 1497, 84, 2, 30, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57401, 1505, 112, 1, 74, "Section"],
Cell[57516, 1508, 902, 27, 30, "Input"],
Cell[58421, 1537, 215, 4, 30, "Text"],
Cell[58639, 1543, 197, 4, 30, "Input"],
Cell[58839, 1549, 249, 6, 30, "Input"],
Cell[59091, 1557, 97, 2, 30, "Input"],
Cell[59191, 1561, 189, 3, 30, "Input"],
Cell[59383, 1566, 94, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[59502, 1571, 629, 18, 34, "Input"],
Cell[60134, 1591, 308, 8, 30, "Output"]
}, Open  ]],
Cell[60457, 1602, 185, 6, 30, "Input"],
Cell[60645, 1610, 231, 7, 30, "Input"],
Cell[60879, 1619, 93, 2, 30, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
